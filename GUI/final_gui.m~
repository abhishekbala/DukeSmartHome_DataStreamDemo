function SmartHomeGUI
%% Initialize Data:
clear; clc;

%% Global Variables
option = 'Aggregate Power';
counter = 0;

%% Input Data
load('phaseData.mat','phaseData');  %% change to read from a csv file
load('timevec.mat', 'timevec')
latest_data = phaseData(:,1);

appStatus={'OFF','OFF','OFF','OFF'};  % data input

%% GUI setup
%  Create and then hide the GUI as it is being constructed.
f = figure('Visible','off','Position',[270,1000,900,700]);
% current_data = [sampleDataSet(:,1)];
% current_time = [sampleTime(:,1)];


%  Construct the components.
ha = axes('Units','Pixels','Position',[100,450,600,200],'Visible','off');
hb = axes('Units','Pixels','Position',[600, 120, 200, 200],'Visible','off');
hpanel = uipanel('Units','Pixels','Title','Appliance Status','FontSize',20,'FontWeight','Bold',...
    'Position',[200,300,400,120],'BackgroundColor','w','FontName','Helvetica');
happ = uicontrol('Parent',hpanel,'Style','text','String',{'HVAC 1','HVAC 2','Hot box','Refridgerator'},...
      'Position',[80,1,120,90],'FontSize',20,'FontName','Helvetica','BackgroundColor','w');
hstatus = uicontrol('Parent',hpanel,'Style','text','String',appStatus,...
      'Position',[220,1,50,90],'FontSize',20,'FontName','Helvetica','BackgroundColor','w');
hpopup = uicontrol('Style','popupmenu',...
    'String',{'HVAC 1','HVAC 2','Hot box','Refridgerator'},...
    'Position',[200,220,200,50],...
    'Callback',{@popup_menu_Callback},...
    'FontSize',20);
  
  


% Initialize the GUI.
% Change units to normalized so components resize automatically.
set([f,ha,hb,hpanel,happ,hstatus,hpopup],...
    'Units','normalized');
% Assign the GUI a name to appear in the window title.
set(f,'Name','Test GUI')
% Move the GUI to the center of the screen.
movegui(f,'center')
% Make the GUI visible.
set(f,'Visible','on' ,'Color','w');
align([ha,hb,hpanel,hpopup],'distribute','none');


%% Live plot
axes(ha);
mplot(1) = plot(linspace(numel(latest_data),1,numel(latest_data)), latest_data);
        title('Smart Home Power Data','FontSize',20,'FontWeight','bold','FontName','Helvetica');
        xlabel(datestr(latest_time(200,1)/86400+719529,1),'FontSize',14);
        ylabel('Power (W)','FontSize',14);
        set(gca,'FontSize',12,'XTick',[0,200],...
            'XTickLabel',{datestr(latest_time(1,1)/86400+719529,13),...
            datestr(latest_time(200,1)/86400+719529,13)});

        while(1)
            axes(ha);
            current_data = circshift(current_data, [-1,0]);
            current_time = circshift(current_time, [-1,0]);
            sampleDataSet(:,1) = circshift(sampleDataSet(:,1), [-1,0]);
            sampleDataSet(:,2) = circshift(sampleDataSet(:,2), [-1,0]);
            sampleDataSet(:,3) = circshift(sampleDataSet(:,3), [-1,0]);
            sampleDataSet(:,4) = circshift(sampleDataSet(:,4), [-1,0]);
            sampleDataSet(:,5) = circshift(sampleDataSet(:,5), [-1,0]);
            sampleTime(:,1) = circshift(sampleTime(:,1), [-1,0]);
            latest_data = flipud(current_data(1:200));
            latest_time = current_time(1:200);
            set(mplot(1), 'YData', latest_data);
            axis([0, 200, 0 , 8000]);
            xlabel(datestr(latest_time(200,1)/86400+719529,1),'FontSize',14);
            ylabel('Power (W)','FontSize',14);
            set(gca,'FontSize',12,'XTick',[0,200],...
                'XTickLabel',{datestr(latest_time(1,1)/86400+719529,13),...
                datestr(latest_time(200,1)/86400+719529,13)});
            counter = counter + 1;
            if counter == 20
                pause(0.01);
            else
                pause(0.5);
            end
            drawnow;
        end

%% Dropdown menu
    function popup_menu_Callback(source,eventdata)
        % Determine the selected data set.
        str = get(source, 'String');
        val = get(source,'Value');
        % Set current data to the selected data set.
        switch str{val};
            case 'HVAC 1'
                current_data = sampleDataSet(:,1);  % data input
                option = 'HVAC 1';
                counter = 20;
            case 'HVAC 2'
                current_data = sampleDataSet(:,2);  % data input
                option = 'HVAC 2';
                counter = 20;
            case 'Hot box'
                current_data = sampleDataSet(:,3);  % data input
                option = 'Hot box';
                counter = 20;
            case 'Refridgerator'
                current_data = sampleDataSet(:,4);  % data input
                option = 'Refridgerator';
                counter = 20;
        end
    end

%% Prediction Plot
axes(hb);
switch option
    case 'HVAC 1'
        plot(current_data)
    case 'HVAC 2'
    case 'Hot box'
    case 'Refridgerator'
end
                        
plot 
end